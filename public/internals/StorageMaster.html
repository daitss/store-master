<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: StorageMaster
  
    &mdash; Storage Master Service
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (S)</a> &raquo; 
    
    
    <span class="title">StorageMaster</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: StorageMaster
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="StorageMasterModel.html" title="StorageMasterModel (module)">StorageMasterModel</a></span>, <span class='object_link'><a href="StorageMasterModel/Authentication.html" title="StorageMasterModel::Authentication (class)">StorageMasterModel::Authentication</a></span>, <span class='object_link'><a href="StorageMasterModel/Copy.html" title="StorageMasterModel::Copy (class)">StorageMasterModel::Copy</a></span>, <span class='object_link'><a href="StorageMasterModel/Package.html" title="StorageMasterModel::Package (class)">StorageMasterModel::Package</a></span>, <span class='object_link'><a href="StorageMasterModel/Pool.html" title="StorageMasterModel::Pool (class)">StorageMasterModel::Pool</a></span>, <span class='object_link'><a href="StorageMasterModel/Reservation.html" title="StorageMasterModel::Reservation (class)">StorageMasterModel::Reservation</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">/Users/fischer/WorkProjects/daitss2/storage-master/lib/storage-master/exceptions.rb<span class="defines">,<br />
  /Users/fischer/WorkProjects/daitss2/storage-master/lib/storage-master.rb,<br /> /Users/fischer/WorkProjects/daitss2/storage-master/lib/app/package-reports.rb,<br /> /Users/fischer/WorkProjects/daitss2/storage-master/lib/storage-master/disk-store.rb,<br /> /Users/fischer/WorkProjects/daitss2/storage-master/lib/storage-master/http-exceptions.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Most of the named exceptions in the service libraries we here assign to one
of the HTTP exception classes.  Libraries are designed specifically to be
unaware of this mapping: they should use their specific low level
exceptions classes, and never the HttpError ones.</p>

<p>In general, if we catch an HttpError at our top level sinatra error
handler, we can blindly return the error message to the client as a
diagnostic and log it.  The fact that we’re subclassing the particular
following exceptions from the Http ones means we’re being careful not to
leak information, and still be helpful to the client.  Since they provide
very specific messages, tracebacks will not be required.</p>

<p>When we get an un-named exception or a named exception that is not
subclassed from the HttpErrors, however, the appropriate thing to do at the
top level is to just supply a very terse message to the client (i.e., we
wouldn’t like to expose errors from an ORM that said something like
“password ‘topsecret’ failed in mysql open”). We <b>will</b> want
to log the full error message, and probably the traceback to boot.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
   
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="StorageMaster/BadName.html" title="StorageMaster::BadName (class)">BadName</a></span>, <span class='object_link'><a href="StorageMaster/BadPassword.html" title="StorageMaster::BadPassword (class)">BadPassword</a></span>, <span class='object_link'><a href="StorageMaster/BadPoolParameter.html" title="StorageMaster::BadPoolParameter (class)">BadPoolParameter</a></span>, <span class='object_link'><a href="StorageMaster/ConfigurationError.html" title="StorageMaster::ConfigurationError (class)">ConfigurationError</a></span>, <span class='object_link'><a href="StorageMaster/DataBaseError.html" title="StorageMaster::DataBaseError (class)">DataBaseError</a></span>, <span class='object_link'><a href="StorageMaster/DiskStore.html" title="StorageMaster::DiskStore (class)">DiskStore</a></span>, <span class='object_link'><a href="StorageMaster/DiskStoreError.html" title="StorageMaster::DiskStoreError (class)">DiskStoreError</a></span>, <span class='object_link'><a href="StorageMaster/DiskStoreResourceExists.html" title="StorageMaster::DiskStoreResourceExists (class)">DiskStoreResourceExists</a></span>, <span class='object_link'><a href="StorageMaster/Http207.html" title="StorageMaster::Http207 (class)">Http207</a></span>, <span class='object_link'><a href="StorageMaster/Http400.html" title="StorageMaster::Http400 (class)">Http400</a></span>, <span class='object_link'><a href="StorageMaster/Http400Error.html" title="StorageMaster::Http400Error (class)">Http400Error</a></span>, <span class='object_link'><a href="StorageMaster/Http401.html" title="StorageMaster::Http401 (class)">Http401</a></span>, <span class='object_link'><a href="StorageMaster/Http403.html" title="StorageMaster::Http403 (class)">Http403</a></span>, <span class='object_link'><a href="StorageMaster/Http404.html" title="StorageMaster::Http404 (class)">Http404</a></span>, <span class='object_link'><a href="StorageMaster/Http405.html" title="StorageMaster::Http405 (class)">Http405</a></span>, <span class='object_link'><a href="StorageMaster/Http406.html" title="StorageMaster::Http406 (class)">Http406</a></span>, <span class='object_link'><a href="StorageMaster/Http408.html" title="StorageMaster::Http408 (class)">Http408</a></span>, <span class='object_link'><a href="StorageMaster/Http409.html" title="StorageMaster::Http409 (class)">Http409</a></span>, <span class='object_link'><a href="StorageMaster/Http410.html" title="StorageMaster::Http410 (class)">Http410</a></span>, <span class='object_link'><a href="StorageMaster/Http411.html" title="StorageMaster::Http411 (class)">Http411</a></span>, <span class='object_link'><a href="StorageMaster/Http412.html" title="StorageMaster::Http412 (class)">Http412</a></span>, <span class='object_link'><a href="StorageMaster/Http413.html" title="StorageMaster::Http413 (class)">Http413</a></span>, <span class='object_link'><a href="StorageMaster/Http414.html" title="StorageMaster::Http414 (class)">Http414</a></span>, <span class='object_link'><a href="StorageMaster/Http415.html" title="StorageMaster::Http415 (class)">Http415</a></span>, <span class='object_link'><a href="StorageMaster/Http500.html" title="StorageMaster::Http500 (class)">Http500</a></span>, <span class='object_link'><a href="StorageMaster/Http500Error.html" title="StorageMaster::Http500Error (class)">Http500Error</a></span>, <span class='object_link'><a href="StorageMaster/Http501.html" title="StorageMaster::Http501 (class)">Http501</a></span>, <span class='object_link'><a href="StorageMaster/Http503.html" title="StorageMaster::Http503 (class)">Http503</a></span>, <span class='object_link'><a href="StorageMaster/Http505.html" title="StorageMaster::Http505 (class)">Http505</a></span>, <span class='object_link'><a href="StorageMaster/HttpError.html" title="StorageMaster::HttpError (class)">HttpError</a></span>, <span class='object_link'><a href="StorageMaster/NoIEID.html" title="StorageMaster::NoIEID (class)">NoIEID</a></span>, <span class='object_link'><a href="StorageMaster/NoReservation.html" title="StorageMaster::NoReservation (class)">NoReservation</a></span>, <span class='object_link'><a href="StorageMaster/PackageCsvReport.html" title="StorageMaster::PackageCsvReport (class)">PackageCsvReport</a></span>, <span class='object_link'><a href="StorageMaster/PackageNotHere.html" title="StorageMaster::PackageNotHere (class)">PackageNotHere</a></span>, <span class='object_link'><a href="StorageMaster/PackageNotHereAnymore.html" title="StorageMaster::PackageNotHereAnymore (class)">PackageNotHereAnymore</a></span>, <span class='object_link'><a href="StorageMaster/PackageUsed.html" title="StorageMaster::PackageUsed (class)">PackageUsed</a></span>, <span class='object_link'><a href="StorageMaster/PackageXmlReport.html" title="StorageMaster::PackageXmlReport (class)">PackageXmlReport</a></span>, <span class='object_link'><a href="StorageMaster/PartialDelete.html" title="StorageMaster::PartialDelete (class)">PartialDelete</a></span>, <span class='object_link'><a href="StorageMaster/SiloStoreError.html" title="StorageMaster::SiloStoreError (class)">SiloStoreError</a></span>, <span class='object_link'><a href="StorageMaster/SiloUnreachable.html" title="StorageMaster::SiloUnreachable (class)">SiloUnreachable</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="REVISION-constant" class="">REVISION =
          
        </dt>
        <dd><pre class="code"><span class='get_capistrano_git_revision identifier id'>get_capistrano_git_revision</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
</pre></dd>
      
        <dt id="RELEASE-constant" class="">RELEASE =
          
        </dt>
        <dd><pre class="code"><span class='get_capistrano_release identifier id'>get_capistrano_release</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
</pre></dd>
      
        <dt id="VERSION-constant" class="">VERSION =
          
        </dt>
        <dd><pre class="code"><span class='File constant id'>File</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='string val'>&quot;../../VERSION&quot;</span><span class='comma token'>,</span><span class='__FILE__ __file__ kw'>__FILE__</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span>
</pre></dd>
      
        <dt id="NAME-constant" class="">NAME =
          
        </dt>
        <dd><pre class="code"><span class='string val'>'Storage Master Service'</span>
</pre></dd>
      
    </dl>
  





  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup_databases-class_method" title="setup_databases (class method)">+ (Object) <strong>setup_databases</strong>(store_db_connection_string, daitss_db_connection_string = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set up DataMapper connections.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#version-class_method" title="version (class method)">+ (Struct) <strong>version</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return version information for the Storage Master service.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="setup_databases-class_method">
  
    + (<tt>Object</tt>) <strong>setup_databases</strong>(store_db_connection_string, daitss_db_connection_string = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Set up DataMapper connections.  Attempts to perform an operation on the
database connections, so we’ll fail fast.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>connection</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>strings for the Storage Master and, optionally, the DAITSS databases.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73
74
75
76
77
78
79</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/storage-master/lib/storage-master.rb', line 71</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='setup_databases identifier id'>setup_databases</span><span class='lparen token'>(</span><span class='store_db_connection_string identifier id'>store_db_connection_string</span><span class='comma token'>,</span> <span class='daitss_db_connection_string identifier id'>daitss_db_connection_string</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>

  <span class='dms identifier id'>dms</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='dms identifier id'>dms</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='StorageMasterModel constant id'>StorageMasterModel</span><span class='dot token'>.</span><span class='setup_db identifier id'>setup_db</span><span class='lparen token'>(</span><span class='store_db_connection_string identifier id'>store_db_connection_string</span><span class='rparen token'>)</span>
  <span class='dms identifier id'>dms</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='Daitss constant id'>Daitss</span><span class='dot token'>.</span><span class='setup_db identifier id'>setup_db</span><span class='lparen token'>(</span><span class='daitss_db_connection_string identifier id'>daitss_db_connection_string</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='daitss_db_connection_string identifier id'>daitss_db_connection_string</span>

  <span class='DataMapper constant id'>DataMapper</span><span class='dot token'>.</span><span class='finalize identifier id'>finalize</span>
  <span class='dms identifier id'>dms</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='dm identifier id'>dm</span><span class='bitor op'>|</span> <span class='dm identifier id'>dm</span><span class='dot token'>.</span><span class='select identifier id'>select</span><span class='lparen token'>(</span><span class='string val'>'select 1 + 1'</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>   <span class='comment val'># fail fast</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="version-class_method">
  
    + (<tt>Struct</tt>) <strong>version</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Return version information for the Storage Master service.</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Struct</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A struct with ‘name’ and ‘uri’ members</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/storage-master/lib/storage-master.rb', line 61</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='version identifier id'>version</span>
  <span class='os identifier id'>os</span> <span class='assign token'>=</span> <span class='OpenStruct constant id'>OpenStruct</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dstring node'>&quot;#{NAME} Version #{VERSION}, Git Revision #{REVISION}, Capistrano Release #{RELEASE}.&quot;</span><span class='comma token'>,</span>
                      <span class='string val'>&quot;uri&quot;</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dstring node'>&quot;info:fcla/daitss/storage-master/#{VERSION}&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Wed Nov 16 18:10:36 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.3 (ruby-1.8.7).
</div>

  </body>
</html>